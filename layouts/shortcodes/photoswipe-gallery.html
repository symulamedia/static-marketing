{{ $align := .Get "align" | default "center" }}
{{ $breakpoints := .Get "breakpoints" }}
{{ $class := .Get "class" }}
{{ $densities := .Get "densities" }}
{{ $fetchpriority := .Get "fetchpriority" }}
{{ $height := .Get "height" }}
{{ $images := .Get 0 | default (.Get "images") }}
{{ $justify := .Get "justify" | default "center" }}
{{ $linked := .Get "linked" }}
{{ $loading := .Get "loading" }}
{{ $maxheight := .Get "maxheight" }}
{{ $maxwidth := .Get "maxwidth" }}
{{ $page := .Page }}
{{ $process := .Get "process" }}
{{ $style := .Get "style" }}
{{ $type := .Get "type" | default "rows" }}
{{ $width := .Get "width" }}

{{ $inner := chomp .Inner }}
{{ $resources := slice }}

{{ if and (not $images) (not $inner) }}
    {{ errorf "layouts/shortcodes/paige/gallery.html: no content" }}
{{ end }}

{{ if not $inner }}
    {{ with $images }}
        {{ with $.Page.Resources.Match . }}
            {{ $resources = . }}
        {{ else }}
            {{ $resources = resources.Match . }}
        {{ end }}
    {{ else }}
        {{ with .Page.Resources.ByType "image" }}
            {{ $resources = . }}
        {{ else }}
            {{ $resources = resources.ByType "image" }}
        {{ end }}
    {{ end }}
{{ end }}

{{/* The markup below cannot be indented due to nested shortcodes within Markdown. */}}

<div class="container-fluid justify-items-center">

<div class="pswp-gallery pswp-gallery--single-column photoswipe-gallery">
{{ range $resources }}
{{ partial "photoswipe-image.html" (dict
    "breakpoints" $breakpoints
    "class" $class
    "densities" $densities
    "fetchpriority" $fetchpriority
    "height" $height
    "linked" $linked
    "loading" $loading
    "maxheight" $maxheight
    "maxwidth" $maxwidth
    "page" $page
    "process" $process
    "resource" .
    "style" (print $style "; height: auto; max-width: 100%")
    "width" $width
    ) }}
    {{ end }}
</div>
</div>